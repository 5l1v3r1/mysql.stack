target:
  os: os.linux.csos
  capabilities:
    - security.lsm.selinux
  dependencies:
    - dns

replicationType: "deployment"

containers:
  - image: mysql:5.7.14
    name: mysql
    version: 5.7.14
    digest:
      sha256: 42692471e4d351bd2970aee690345d9209f4c52cdaed7bea1b72ab9088c7f584

    policies:
      - policy/example.te

    resources:
      limit:
        cpu: 250m # == 1000m
        memory: 256Mi # E, P, T, G, M, K, Ei, Pi, Ti, Gi, Mi, Ki
      request:
        cpu: 100m
        memory: 128Mi

    services:
      - type: LoadBalancer
        ports:
        - protocol: TCP
          port: 3306

    ports:
      - protocol: TCP
        port: 3306
        
    env:
      - name: MYSQL_ALLOW_EMPTY_PASSWORD
        value: true
      - name: MYSQL_USER
        value: mysql-config{database.user}
        type: config
      - name: MYSQL_DATABASE
        value: mysql-config{database.db}
        type: config
      - name: MYSQL_ROOT_PASSWORD
        value: mysql-secrets{database.password}
        type: secret
